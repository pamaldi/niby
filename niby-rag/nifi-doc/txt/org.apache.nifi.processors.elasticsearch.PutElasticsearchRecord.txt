PutElasticsearchRecord - Apache NiFi

• Documentation • NiFi Version 2 Documentation • NiFi Version 1 Documentation • Guides • Security Reporting • Wiki • Development • Contributing • Issues • Source • Community • Contact • Powered By • Team • Projects • MiNiFi • Registry • Flow Design System • Apache • Events • License • Privacy • Sponsorship • Thanks • General • Overview • Getting Started • User Guide • Expression Language Guide • RecordPath Guide • Admin Guide • Toolkit Guide • Walkthroughs • Developer • Developer Guide • Python Developer Guide • Apache NiFi In Depth • REST API • Processors • AttributeRollingWindow • AttributesToCSV • AttributesToJSON • CalculateRecordStats • CaptureChangeMySQL • CompressContent • ConnectWebSocket • ConsumeAMQP • ConsumeAzureEventHub • ConsumeBoxEnterpriseEvents • ConsumeBoxEvents • ConsumeElasticsearch • ConsumeGCPubSub • ConsumeIMAP • ConsumeJMS • ConsumeKafka • ConsumeKinesisStream • ConsumeMQTT • ConsumePOP3 • ConsumeSlack • ConsumeTwitter • ConsumeWindowsEventLog • ControlRate • ConvertCharacterSet • ConvertRecord • CopyAzureBlobStorage_v12 • CopyS3Object • CountText • CreateBoxFileMetadataInstance • CreateBoxMetadataTemplate • CryptographicHashContent • DebugFlow • DecryptContentAge • DecryptContentPGP • DeduplicateRecord • DeleteAzureBlobStorage_v12 • DeleteAzureDataLakeStorage • DeleteBoxFileMetadataInstance • DeleteByQueryElasticsearch • DeleteDynamoDB • DeleteFile • DeleteGCSObject • DeleteGridFS • DeleteMongo • DeleteS3Object • DeleteSFTP • DeleteSQS • DetectDuplicate • DistributeLoad • DuplicateFlowFile • EncodeContent • EncryptContentAge • EncryptContentPGP • EnforceOrder • EvaluateJsonPath • EvaluateXPath • EvaluateXQuery • ExecuteGroovyScript • ExecuteProcess • ExecuteScript • ExecuteSQL • ExecuteSQLRecord • ExecuteStreamCommand • ExtractAvroMetadata • ExtractEmailAttachments • ExtractEmailHeaders • ExtractGrok • ExtractHL7Attributes • ExtractRecordSchema • ExtractStructuredBoxFileMetadata • ExtractText • FetchAzureBlobStorage_v12 • FetchAzureDataLakeStorage • FetchBoxFile • FetchBoxFileInfo • FetchBoxFileMetadataInstance • FetchBoxFileRepresentation • FetchDistributedMapCache • FetchDropbox • FetchFile • FetchFTP • FetchGCSObject • FetchGoogleDrive • FetchGridFS • FetchS3Object • FetchSFTP • FetchSmb • FilterAttribute • FlattenJson • ForkEnrichment • ForkRecord • GenerateFlowFile • GenerateRecord • GenerateTableFetch • GeoEnrichIP • GeoEnrichIPRecord • GeohashRecord • GetAsanaObject • GetAwsPollyJobStatus • GetAwsTextractJobStatus • GetAwsTranscribeJobStatus • GetAwsTranslateJobStatus • GetAzureEventHub • GetAzureQueueStorage_v12 • GetBoxFileCollaborators • GetBoxGroupMembers • GetDynamoDB • GetElasticsearch • GetFile • GetFileResource • GetFTP • GetGcpVisionAnnotateFilesOperationStatus • GetGcpVisionAnnotateImagesOperationStatus • GetHubSpot • GetMongo • GetMongoRecord • GetS3ObjectMetadata • GetS3ObjectTags • GetSFTP • GetShopify • GetSmbFile • GetSNMP • GetSplunk • GetSQS • GetWorkdayReport • GetZendesk • HandleHttpRequest • HandleHttpResponse • IdentifyMimeType • InvokeHTTP • InvokeScriptedProcessor • ISPEnrichIP • JoinEnrichment • JoltTransformJSON • JoltTransformRecord • JSLTTransformJSON • JsonQueryElasticsearch • ListAzureBlobStorage_v12 • ListAzureDataLakeStorage • ListBoxFile • ListBoxFileInfo • ListBoxFileMetadataInstances • ListBoxFileMetadataTemplates • ListDatabaseTables • ListDropbox • ListenFTP • ListenHTTP • ListenOTLP • ListenSlack • ListenSyslog • ListenTCP • ListenTrapSNMP • ListenUDP • ListenUDPRecord • ListenWebSocket • ListFile • ListFTP • ListGCSBucket • ListGoogleDrive • ListS3 • ListSFTP • ListSmb • LogAttribute • LogMessage • LookupAttribute • LookupRecord • MergeContent • MergeRecord • ModifyBytes • ModifyCompression • MonitorActivity • MoveAzureDataLakeStorage • Notify • PackageFlowFile • PaginatedJsonQueryElasticsearch • ParseEvtx • ParseNetflowv5 • ParseSyslog • ParseSyslog5424 • PartitionRecord • PublishAMQP • PublishGCPubSub • PublishJMS • PublishKafka • PublishMQTT • PublishSlack • PutAzureBlobStorage_v12 • PutAzureCosmosDBRecord • PutAzureDataExplorer • PutAzureDataLakeStorage • PutAzureEventHub • PutAzureQueueStorage_v12 • PutBigQuery • PutBoxFile • PutCloudWatchMetric • PutDatabaseRecord • PutDistributedMapCache • PutDropbox • PutDynamoDB • PutDynamoDBRecord • PutElasticsearchJson • PutElasticsearchRecord • PutEmail • PutFile • PutFTP • PutGCSObject • PutGoogleDrive • PutGridFS • PutKinesisFirehose • PutKinesisStream • PutLambda • PutMongo • PutMongoBulkOperations • PutMongoRecord • PutRecord • PutRedisHashRecord • PutS3Object • PutSalesforceObject • PutSFTP • PutSmbFile • PutSNS • PutSplunk • PutSplunkHTTP • PutSQL • PutSQS • PutSyslog • PutTCP • PutUDP • PutWebSocket • PutZendeskTicket • QueryAirtableTable • QueryAzureDataExplorer • QueryDatabaseTable • QueryDatabaseTableRecord • QueryRecord • QuerySalesforceObject • QuerySplunkIndexingStatus • RemoveRecordField • RenameRecordField • ReplaceText • ReplaceTextWithMapping • RetryFlowFile • RouteHL7 • RouteOnAttribute • RouteOnContent • RouteText • RunMongoAggregation • SampleRecord • ScanAttribute • ScanContent • ScriptedFilterRecord • ScriptedPartitionRecord • ScriptedTransformRecord • ScriptedValidateRecord • SearchElasticsearch • SegmentContent • SendTrapSNMP • SetSNMP • SignContentPGP • SplitAvro • SplitContent • SplitExcel • SplitJson • SplitPCAP • SplitRecord • SplitText • SplitXml • StartAwsPollyJob • StartAwsTextractJob • StartAwsTranscribeJob • StartAwsTranslateJob • StartGcpVisionAnnotateFilesOperation • StartGcpVisionAnnotateImagesOperation • TagS3Object • TailFile • TransformXml • UnpackContent • UpdateAttribute • UpdateBoxFileMetadataInstance • UpdateByQueryElasticsearch • UpdateCounter • UpdateDatabaseTable • UpdateRecord • ValidateCsv • ValidateJson • ValidateRecord • ValidateXml • VerifyContentMAC • VerifyContentPGP • Wait • Controller Services • ADLSCredentialsControllerService • ADLSCredentialsControllerServiceLookup • AmazonGlueEncodedSchemaReferenceReader • AmazonGlueSchemaRegistry • AmazonMSKConnectionService • ApicurioSchemaRegistry • AvroReader • AvroRecordSetWriter • AvroSchemaRegistry • AWSCredentialsProviderControllerService • AzureBlobStorageFileResourceService • AzureCosmosDBClientService • AzureDataLakeStorageFileResourceService • AzureEventHubRecordSink • AzureStorageCredentialsControllerService_v12 • AzureStorageCredentialsControllerServiceLookup_v12 • CEFReader • ConfluentEncodedSchemaReferenceReader • ConfluentEncodedSchemaReferenceWriter • ConfluentSchemaRegistry • CSVReader • CSVRecordLookupService • CSVRecordSetWriter • DatabaseRecordLookupService • DatabaseRecordSink • DatabaseTableSchemaRegistry • DBCPConnectionPool • DBCPConnectionPoolLookup • DeveloperBoxClientService • DistributedMapCacheLookupService • ElasticSearchClientServiceImpl • ElasticSearchLookupService • ElasticSearchStringLookupService • EmailRecordSink • EmbeddedHazelcastCacheManager • ExcelReader • ExternalHazelcastCacheManager • FreeFormTextRecordSetWriter • GCPCredentialsControllerService • GCSFileResourceService • GrokReader • HazelcastMapCacheClient • HikariCPConnectionPool • HttpRecordSink • IPLookupService • JettyWebSocketClient • JettyWebSocketServer • JMSConnectionFactoryProvider • JndiJmsConnectionFactoryProvider • JsonConfigBasedBoxClientService • JsonPathReader • JsonRecordSetWriter • JsonTreeReader • JWTBearerOAuth2AccessTokenProvider • Kafka3ConnectionService • KerberosKeytabUserService • KerberosPasswordUserService • KerberosTicketCacheUserService • LoggingRecordSink • MapCacheClientService • MapCacheServer • MongoDBControllerService • MongoDBLookupService • PEMEncodedSSLContextProvider • PropertiesFileLookupService • ProtobufReader • ReaderLookup • RecordSetWriterLookup • RecordSinkServiceLookup • RedisConnectionPoolService • RedisDistributedMapCacheClientService • RestLookupService • S3FileResourceService • ScriptedLookupService • ScriptedReader • ScriptedRecordSetWriter • ScriptedRecordSink • SetCacheClientService • SetCacheServer • SimpleCsvFileLookupService • SimpleDatabaseLookupService • SimpleKeyValueLookupService • SimpleRedisDistributedMapCacheClientService • SimpleScriptedLookupService • SiteToSiteReportingRecordSink • SlackRecordSink • SmbjClientProviderService • StandardAsanaClientProviderService • StandardAzureCredentialsControllerService • StandardDatabaseDialectService • StandardDropboxCredentialService • StandardFileResourceService • StandardHashiCorpVaultClientService • StandardHttpContextMap • StandardJsonSchemaRegistry • StandardKustoIngestService • StandardKustoQueryService • StandardOauth2AccessTokenProvider • StandardPGPPrivateKeyService • StandardPGPPublicKeyService • StandardPrivateKeyService • StandardProxyConfigurationService • StandardRestrictedSSLContextService • StandardS3EncryptionService • StandardSSLContextService • StandardWebClientServiceProvider • Syslog5424Reader • SyslogReader • UDPEventRecordSink • VolatileSchemaCache • WindowsEventLogReader • XMLFileLookupService • XMLReader • XMLRecordSetWriter • YamlTreeReader • ZendeskRecordSink • Reporting Tasks • AzureLogAnalyticsProvenanceReportingTask • AzureLogAnalyticsReportingTask • ControllerStatusReportingTask • MonitorDiskUsage • MonitorMemory • ScriptedReportingTask • SiteToSiteBulletinReportingTask • SiteToSiteMetricsReportingTask • SiteToSiteProvenanceReportingTask • SiteToSiteStatusReportingTask • Parameter Providers • AwsSecretsManagerParameterProvider • AzureKeyVaultSecretsParameterProvider • DatabaseParameterProvider • EnvironmentVariableParameterProvider • GcpSecretManagerParameterProvider • HashiCorpVaultParameterProvider • KubernetesSecretParameterProvider • OnePasswordParameterProvider • Flow Analysis Rules • DisallowComponentType • RequireServerSSLContextService • RestrictBackpressureSettings • RestrictFlowFileExpiration PutElasticsearchRecord 2.5.0

 Bundle org.apache.nifi | nifi-elasticsearch-restapi-nar Description A record-aware Elasticsearch put processor that uses the official Elastic REST client libraries. Each Record within the FlowFile is converted into a document to be sent to the Elasticsearch _bulk APi. Multiple documents can be batched into each Request sent to Elasticsearch. Each document's Bulk operation can be configured using Record Path expressions. Tags elasticsearch, elasticsearch7, elasticsearch8, elasticsearch9, index, json, put, record Input Requirement REQUIRED Supports Sensitive Dynamic Properties false • Additional Details for PutElasticsearchRecord 2.5.0 PutElasticsearchRecord

 This processor is for accessing the Elasticsearch Bulk API. It provides the ability to configure bulk operations on a per-record basis which is what separates it from PutElasticsearchJson. For example, it is possible to define multiple commands to index documents, followed by deletes, creates and update operations against the same index or other indices as desired.

 As part of the Elasticsearch REST API bundle, it uses a controller service to manage connection information and that controller service is built on top of the official Elasticsearch client APIs. That provides features such as automatic master detection against the cluster which is missing in the other bundles.

 This processor builds one Elasticsearch Bulk API body per record set. Care should be taken to split up record sets into appropriately-sized chunks so that NiFi does not run out of memory and the requests sent to Elasticsearch are not too large for it to handle. When failures do occur, this processor is capable of attempting to write the records that failed to an output record writer so that only failed records can be processed downstream or replayed.

 Per-Record Actions

 The index, operation and (optional) type fields are configured with default values that can be overridden using record path operations that find an index or type value in the record set. The ID and operation type (create, index, update, upsert or delete) can also be extracted in a similar fashion from the record set. A “@timestamp” field can be added to the data either using a default or by extracting it from the record set. This is useful if the documents are being indexed into an Elasticsearch Data Stream.

 Example - per-record actions

 The following is an example of a document exercising all of these features:

 {
 "metadata": {
 "id": "12345",
 "index": "test",
 "type": "message",
 "operation": "index"
 },
 "message": "Hello, world",
 "from": "john.smith",
 "ts": "2021-12-03'T'14:00:00.000Z"
}
 {
 "metadata": {
 "id": "12345",
 "index": "test",
 "type": "message",
 "operation": "delete"
 }
}
 The record path operations below would extract the relevant data:

 • /metadata/id • /metadata/index • metadata/type • metadata/operation • /ts Dynamic Templates

 Index and Create operations can use Dynamic Templates from the Record, record path operations can be configured to find the Dynamic Templates from the record set. Dynamic Templates fields in Records must either be a Map, child Record or a string that can be parsable as a JSON object.

 Example - Index with Dynamic Templates

 {
 "message": "Hello, world",
 "dynamic_templates": "{\"message\": \"keyword_lower\"}"
}
 The record path operation below would extract the relevant Dynamic Templates:

 • /dynamic_templates Would create Elasticsearch action:

 {
 "index": {
 "_id": "1",
 "_index": "test",
 "dynamic_templates": {
 "message": "keyword_lower"
 }
 }
}
 {
 "doc": {
 "message": "Hello, world"
 }
}
 Update/Upsert Scripts

 Update and Upsert operations can use a script from the Record, record path operations can be configured to find the script from the record set. Scripts must contain all the elements required by Elasticsearch, e.g. source and lang. Script fields in Records must either be a Map, child Record or a string that can be parsable as a JSON object.

 If a script is defined for an upset, any fields remaining in the Record will be used as the upsert fields in the Elasticsearch action. If no script is defined, all Record fields will be used as the update doc (or doc_as_upsert for upsert operations).

 Example - Update without Script

 {
 "message": "Hello, world",
 "from": "john.smith"
}
 Would create Elasticsearch action:

 {
 "update": {
 "_id": "1",
 "_index": "test"
 }
}
 {
 "doc": {
 "message": "Hello, world",
 "from": "john.smith"
 }
}
 Example - Upsert with Script

 {
 "counter": 1,
 "script": {
 "source": "ctx._source.counter += params.param1",
 "lang": "painless",
 "params": {
 "param1": 1
 }
 }
}
 The record path operation below would extract the relevant script:

 • /script Would create Elasticsearch action:

 {
 "update": {
 "_id": "1",
 "_index": "test"
 }
}
 {
 "script": {
 "source": "ctx._source.counter += params.param1",
 "lang": "painless",
 "params": {
 "param1": 1
 }
 },
 "upsert": {
 "counter": 1
 }
}
 Bulk Action Header Fields

 Dynamic Properties can be defined on the processor with BULK: prefixes. The value of the Dynamic Property is a record path operation to find the field value from the record set. Users must ensure that only known Bulk action fields are sent to Elasticsearch for the relevant index operation defined for the Record, Elasticsearch will reject invalid combinations of index operation and Bulk action fields.

 Example - Update with Retry on Conflict

 {
 "message": "Hello, world",
 "from": "john.smith",
 "retry": 3
}
 The Dynamic Property and record path operation below would extract the relevant field:

 • BULK:retry_on_conflict = /retry Would create Elasticsearch action:

 {
 "update": {
 "_id": "1",
 "_index": "test",
 "retry_on_conflict": 3
 }
}
 {
 "doc": {
 "message": "Hello, world",
 "from": "john.smith"
 }
}
 Index Operations

 Valid values for “operation” are:

 • create • delete • index • update • upsert Properties • Client Service An Elasticsearch client service to use for running queries. Display Name Client Service Description An Elasticsearch client service to use for running queries. API Name el-rest-client-service Service Interface org.apache.nifi.elasticsearch.ElasticSearchClientService Service Implementations org.apache.nifi.elasticsearch.ElasticSearchClientServiceImpl Expression Language Scope Not Supported Sensitive false Required true • Index The name of the index to use. Display Name Index Description The name of the index to use. API Name el-rest-fetch-index Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required true • Type The type of this document (used by Elasticsearch for indexing and searching). Display Name Type Description The type of this document (used by Elasticsearch for indexing and searching). API Name el-rest-type Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false • Max JSON Field String Length The maximum allowed length of a string value when parsing a JSON document or attribute. Display Name Max JSON Field String Length Description The maximum allowed length of a string value when parsing a JSON document or attribute. API Name Max JSON Field String Length Default Value 20 MB Expression Language Scope Not Supported Sensitive false Required true • Treat "Not Found" as Success If true, "not_found" Elasticsearch Document associated Records will be routed to the "successful" relationship, otherwise to the "errors" relationship. If Output Error Responses is "true" then "not_found" responses from Elasticsearch will be sent to the error_responses relationship. Display Name Treat "Not Found" as Success Description If true, "not_found" Elasticsearch Document associated Records will be routed to the "successful" relationship, otherwise to the "errors" relationship. If Output Error Responses is "true" then "not_found" responses from Elasticsearch will be sent to the error_responses relationship. API Name put-es-not_found-is-error Default Value true Allowable Values • true • false Expression Language Scope Not Supported Sensitive false Required false • Output Error Responses If this is enabled, response messages from Elasticsearch marked as "error" will be output to the "error_responses" relationship.This does not impact the output of flowfiles to the "successful" or "errors" relationships Display Name Output Error Responses Description If this is enabled, response messages from Elasticsearch marked as "error" will be output to the "error_responses" relationship.This does not impact the output of flowfiles to the "successful" or "errors" relationships API Name put-es-output-error-responses Default Value false Allowable Values • true • false Expression Language Scope Not Supported Sensitive false Required false • @timestamp Value The value to use as the @timestamp field (required for Elasticsearch Data Streams) Display Name @timestamp Value Description The value to use as the @timestamp field (required for Elasticsearch Data Streams) API Name put-es-record-at-timestamp Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false • Date Format Specifies the format to use when writing Date fields. If not specified, the default format 'yyyy-MM-dd' is used. If specified, the value must match the Java Simple Date Format (for example, MM/dd/yyyy for a two-digit month, followed by a two-digit day, followed by a four-digit year, all separated by '/' characters, as in 01/25/2017). Display Name Date Format Description Specifies the format to use when writing Date fields. If not specified, the default format 'yyyy-MM-dd' is used. If specified, the value must match the Java Simple Date Format (for example, MM/dd/yyyy for a two-digit month, followed by a two-digit day, followed by a four-digit year, all separated by '/' characters, as in 01/25/2017). API Name put-es-record-at-timestamp-date-format Expression Language Scope Environment variables defined at JVM level and system properties Sensitive false Required false • @timestamp Record Path A RecordPath pointing to a field in the record(s) that contains the @timestamp for the document. If left blank the @timestamp will be determined using the main @timestamp property Display Name @timestamp Record Path Description A RecordPath pointing to a field in the record(s) that contains the @timestamp for the document. If left blank the @timestamp will be determined using the main @timestamp property API Name put-es-record-at-timestamp-path Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false • Time Format Specifies the format to use when writing Time fields. If not specified, the default format 'HH:mm:ss' is used. If specified, the value must match the Java Simple Date Format (for example, HH:mm:ss for a two-digit hour in 24-hour format, followed by a two-digit minute, followed by a two-digit second, all separated by ':' characters, as in 18:04:15). Display Name Time Format Description Specifies the format to use when writing Time fields. If not specified, the default format 'HH:mm:ss' is used. If specified, the value must match the Java Simple Date Format (for example, HH:mm:ss for a two-digit hour in 24-hour format, followed by a two-digit minute, followed by a two-digit second, all separated by ':' characters, as in 18:04:15). API Name put-es-record-at-timestamp-time-format Expression Language Scope Environment variables defined at JVM level and system properties Sensitive false Required false • Timestamp Format Specifies the format to use when writing Timestamp fields. If not specified, the default format 'yyyy-MM-dd HH:mm:ss' is used. If specified, the value must match the Java Simple Date Format (for example, MM/dd/yyyy HH:mm:ss for a two-digit month, followed by a two-digit day, followed by a four-digit year, all separated by '/' characters; and then followed by a two-digit hour in 24-hour format, followed by a two-digit minute, followed by a two-digit second, all separated by ':' characters, as in 01/25/2017 18:04:15). Display Name Timestamp Format Description Specifies the format to use when writing Timestamp fields. If not specified, the default format 'yyyy-MM-dd HH:mm:ss' is used. If specified, the value must match the Java Simple Date Format (for example, MM/dd/yyyy HH:mm:ss for a two-digit month, followed by a two-digit day, followed by a four-digit year, all separated by '/' characters; and then followed by a two-digit hour in 24-hour format, followed by a two-digit minute, followed by a two-digit second, all separated by ':' characters, as in 01/25/2017 18:04:15). API Name put-es-record-at-timestamp-timestamp-format Expression Language Scope Environment variables defined at JVM level and system properties Sensitive false Required false • Batch Size The number of records to send over in a single batch. Display Name Batch Size Description The number of records to send over in a single batch. API Name put-es-record-batch-size Default Value 100 Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required true • Group Results by Bulk Error Type The errored records written to the "errors" relationship will be grouped by error type and the error related to the first record within the FlowFile added to the FlowFile as "elasticsearch.bulk.error". If "Treat "Not Found" as Success" is "false" then records associated with "not_found" Elasticsearch document responses will also be send to the "errors" relationship. Display Name Group Results by Bulk Error Type Description The errored records written to the "errors" relationship will be grouped by error type and the error related to the first record within the FlowFile added to the FlowFile as "elasticsearch.bulk.error". If "Treat "Not Found" as Success" is "false" then records associated with "not_found" Elasticsearch document responses will also be send to the "errors" relationship. API Name put-es-record-bulk-error-groups Default Value false Allowable Values • true • false Expression Language Scope Not Supported Sensitive false Required false Dependencies • Result Record Writer is set to any value specified • Dynamic Templates Record Path A RecordPath pointing to a field in the record(s) that contains the dynamic_templates for the document. Field must be Map-type compatible (e.g. a Map or Record) or a String parsable into a JSON Object. Requires Elasticsearch 7+ Display Name Dynamic Templates Record Path Description A RecordPath pointing to a field in the record(s) that contains the dynamic_templates for the document. Field must be Map-type compatible (e.g. a Map or Record) or a String parsable into a JSON Object. Requires Elasticsearch 7+ API Name put-es-record-dynamic-templates-path Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false • Result Record Writer The response from Elasticsearch will be examined for failed records and the failed records will be written to a record set with this record writer service and sent to the "errors" relationship. Successful records will be written to a record set with this record writer service and sent to the "successful" relationship. Display Name Result Record Writer Description The response from Elasticsearch will be examined for failed records and the failed records will be written to a record set with this record writer service and sent to the "errors" relationship. Successful records will be written to a record set with this record writer service and sent to the "successful" relationship. API Name put-es-record-error-writer Service Interface org.apache.nifi.serialization.RecordSetWriterFactory Service Implementations org.apache.nifi.avro.AvroRecordSetWriter org.apache.nifi.csv.CSVRecordSetWriter org.apache.nifi.text.FreeFormTextRecordSetWriter org.apache.nifi.json.JsonRecordSetWriter org.apache.nifi.lookup.RecordSetWriterLookup org.apache.nifi.record.script.ScriptedRecordSetWriter org.apache.nifi.xml.XMLRecordSetWriter Expression Language Scope Not Supported Sensitive false Required true • ID Record Path A record path expression to retrieve the ID field for use with Elasticsearch. If left blank the ID will be automatically generated by Elasticsearch. Display Name ID Record Path Description A record path expression to retrieve the ID field for use with Elasticsearch. If left blank the ID will be automatically generated by Elasticsearch. API Name put-es-record-id-path Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false • Index Operation The type of the operation used to index (create, delete, index, update, upsert) Display Name Index Operation Description The type of the operation used to index (create, delete, index, update, upsert) API Name put-es-record-index-op Default Value index Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required true • Index Operation Record Path A record path expression to retrieve the Index Operation field for use with Elasticsearch. If left blank the Index Operation will be determined using the main Index Operation property. Display Name Index Operation Record Path Description A record path expression to retrieve the Index Operation field for use with Elasticsearch. If left blank the Index Operation will be determined using the main Index Operation property. API Name put-es-record-index-op-path Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false • Index Record Path A record path expression to retrieve the index field for use with Elasticsearch. If left blank the index will be determined using the main index property. Display Name Index Record Path Description A record path expression to retrieve the index field for use with Elasticsearch. If left blank the index will be determined using the main index property. API Name put-es-record-index-record-path Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false • Log Error Responses If this is enabled, errors will be logged to the NiFi logs at the error log level. Otherwise, they will only be logged if debug logging is enabled on NiFi as a whole. The purpose of this option is to give the user the ability to debug failed operations without having to turn on debug logging. Display Name Log Error Responses Description If this is enabled, errors will be logged to the NiFi logs at the error log level. Otherwise, they will only be logged if debug logging is enabled on NiFi as a whole. The purpose of this option is to give the user the ability to debug failed operations without having to turn on debug logging. API Name put-es-record-log-error-responses Default Value false Allowable Values • true • false Expression Language Scope Not Supported Sensitive false Required false • Record Reader The record reader to use for reading incoming records from flowfiles. Display Name Record Reader Description The record reader to use for reading incoming records from flowfiles. API Name put-es-record-reader Service Interface org.apache.nifi.serialization.RecordReaderFactory Service Implementations org.apache.nifi.avro.AvroReader org.apache.nifi.cef.CEFReader org.apache.nifi.csv.CSVReader org.apache.nifi.excel.ExcelReader org.apache.nifi.grok.GrokReader org.apache.nifi.json.JsonPathReader org.apache.nifi.json.JsonTreeReader org.apache.nifi.services.protobuf.ProtobufReader org.apache.nifi.lookup.ReaderLookup org.apache.nifi.record.script.ScriptedReader org.apache.nifi.syslog.Syslog5424Reader org.apache.nifi.syslog.SyslogReader org.apache.nifi.windowsevent.WindowsEventLogReader org.apache.nifi.xml.XMLReader org.apache.nifi.yaml.YamlTreeReader Expression Language Scope Not Supported Sensitive false Required true • Retain @timestamp (Record Path) Whether to retain the existing field used as the @timestamp Record Path. Display Name Retain @timestamp (Record Path) Description Whether to retain the existing field used as the @timestamp Record Path. API Name put-es-record-retain-at-timestamp-field Default Value false Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false Dependencies • @timestamp Record Path is set to any value specified • Retain ID (Record Path) Whether to retain the existing field used as the ID Record Path. Display Name Retain ID (Record Path) Description Whether to retain the existing field used as the ID Record Path. API Name put-es-record-retain-id-field Default Value false Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false Dependencies • ID Record Path is set to any value specified • Script Record Path A RecordPath pointing to a field in the record(s) that contains the script for the document update/upsert. Only applies to Update/Upsert operations. Field must be Map-type compatible (e.g. a Map or a Record) or a String parsable into a JSON Object Display Name Script Record Path Description A RecordPath pointing to a field in the record(s) that contains the script for the document update/upsert. Only applies to Update/Upsert operations. Field must be Map-type compatible (e.g. a Map or a Record) or a String parsable into a JSON Object API Name put-es-record-script-path Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false • Scripted Upsert Record Path A RecordPath pointing to a field in the record(s) that contains the scripted_upsert boolean flag. Whether to add the scripted_upsert flag to the Upsert Operation. Forces Elasticsearch to execute the Script whether or not the document exists, defaults to false. If the Upsert Document provided (from FlowFile content) will be empty, but sure to set the Client Service controller service's Suppress Null/Empty Values to Never Suppress or no "upsert" doc will be, included in the request to Elasticsearch and the operation will not create a new document for the script to execute against, resulting in a "not_found" error Display Name Scripted Upsert Record Path Description A RecordPath pointing to a field in the record(s) that contains the scripted_upsert boolean flag. Whether to add the scripted_upsert flag to the Upsert Operation. Forces Elasticsearch to execute the Script whether or not the document exists, defaults to false. If the Upsert Document provided (from FlowFile content) will be empty, but sure to set the Client Service controller service's Suppress Null/Empty Values to Never Suppress or no "upsert" doc will be, included in the request to Elasticsearch and the operation will not create a new document for the script to execute against, resulting in a "not_found" error API Name put-es-record-scripted-upsert-path Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false • Type Record Path A record path expression to retrieve the type field for use with Elasticsearch. If left blank the type will be determined using the main type property. Display Name Type Record Path Description A record path expression to retrieve the type field for use with Elasticsearch. If left blank the type will be determined using the main type property. API Name put-es-record-type-record-path Expression Language Scope Environment variables and FlowFile Attributes Sensitive false Required false Dynamic Properties • The name of the Bulk request header Prefix: BULK: - adds the specified property name/value as a Bulk request header in the Elasticsearch Bulk API body used for processing. If the Record Path expression results in a null or blank value, the Bulk header will be omitted for the document operation. These parameters will override any matching parameters in the _bulk request body. Name The name of the Bulk request header Description Prefix: BULK: - adds the specified property name/value as a Bulk request header in the Elasticsearch Bulk API body used for processing. If the Record Path expression results in a null or blank value, the Bulk header will be omitted for the document operation. These parameters will override any matching parameters in the _bulk request body. Value A Record Path expression to retrieve the Bulk request header value Expression Language Scope FLOWFILE_ATTRIBUTES • The name of the HTTP request header Prefix: HEADER: - adds the specified property name/value as a HTTP request header in the Elasticsearch request. If the Record Path expression results in a null or blank value, the HTTP request header will be omitted. Name The name of the HTTP request header Description Prefix: HEADER: - adds the specified property name/value as a HTTP request header in the Elasticsearch request. If the Record Path expression results in a null or blank value, the HTTP request header will be omitted. Value A Record Path expression to retrieve the HTTP request header value Expression Language Scope FLOWFILE_ATTRIBUTES • The name of a URL query parameter to add Adds the specified property name/value as a query parameter in the Elasticsearch URL used for processing. These parameters will override any matching parameters in the _bulk request body Name The name of a URL query parameter to add Description Adds the specified property name/value as a query parameter in the Elasticsearch URL used for processing. These parameters will override any matching parameters in the _bulk request body Value The value of the URL query parameter Expression Language Scope FLOWFILE_ATTRIBUTES System Resource Considerations Resource | Description | 
 MEMORY | The Batch of Records will be stored in memory until the bulk operation is performed. | 
 Relationships Name | Description | 
 errors | Record(s)/Flowfile(s) corresponding to Elasticsearch document(s) that resulted in an "error" (within Elasticsearch) will be routed here. | 
 failure | All flowfiles that fail for reasons unrelated to server availability go to this relationship. | 
 original | All flowfiles that are sent to Elasticsearch without request failures go to this relationship. | 
 retry | All flowfiles that fail due to server/cluster availability go to this relationship. | 
 successful | Record(s)/Flowfile(s) corresponding to Elasticsearch document(s) that did not result in an "error" (within Elasticsearch) will be routed here. | 
 Writes Attributes Name | Description | 
 elasticsearch.put.error | The error message if there is an issue parsing the FlowFile records, sending the parsed documents to Elasticsearch or parsing the Elasticsearch response. | 
 elasticsearch.put.error.count | The number of records that generated errors in the Elasticsearch _bulk API. | 
 elasticsearch.put.success.count | The number of records that were successfully processed by the Elasticsearch _bulk API. | 
 elasticsearch.bulk.error | The _bulk response if there was an error during processing the record within Elasticsearch. | 
 See Also • org.apache.nifi.processors.elasticsearch.PutElasticsearchJson